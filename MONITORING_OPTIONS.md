# –í–∞—Ä–∏–∞–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è fail2ban

## üìä –í–∞—Ä–∏–∞–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É)

### 1. ‚úÖ –ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ (—É–∂–µ –µ—Å—Ç—å)
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ  
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** –¢–æ–ª—å–∫–æ fail2ban-client  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ —Ä–æ–ª–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
fail2ban-client status

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ jail
fail2ban-client status sshd

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö IP
fail2ban-client status sshd | grep "Banned IP list"
```

**–ü–ª—é—Å—ã:**
- –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ —Ä–æ–ª–∏ (`fail2ban_collect_metrics`)
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏
- –ù–µ—Ç –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –ù–µ—Ç –∞–ª–µ—Ä—Ç–æ–≤

---

### 2. üìß Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (—É–∂–µ –µ—Å—Ç—å –≤ —Ä–æ–ª–∏)
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ü—Ä–æ—Å—Ç–æ  
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π MTA (sendmail/postfix)  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ email –ø—Ä–∏ –±–∞–Ω–µ IP

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
```yaml
fail2ban_config:
  destemail: "admin@example.com"
fail2ban_send_email: true
```

**–ü–ª—é—Å—ã:**
- –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**–ú–∏–Ω—É—Å—ã:**
- –¢–æ–ª—å–∫–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –Ω–µ—Ç –º–µ—Ç—Ä–∏–∫
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ email

---

### 3. üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ syslog/journald
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ü—Ä–æ—Å—Ç–æ  
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** rsyslog –∏–ª–∏ systemd  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—Å–µ —Å–æ–±—ã—Ç–∏—è fail2ban –≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–æ–≥–∞—Ö

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
```yaml
fail2ban_config:
  logtarget: "SYSLOG"  # –∏–ª–∏ "/var/log/fail2ban.log"
  loglevel: "INFO"
```

**–ü–ª—é—Å—ã:**
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- –ò—Å—Ç–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ—Ç –º–µ—Ç—Ä–∏–∫
- –ù—É–∂–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ –ª–æ–≥–æ–≤ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

---

### 4. ü§ñ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω–µ  
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** Telegram –±–æ—Ç (—É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å exchanger-bot)  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –ø—Ä–∏ –±–∞–Ω–µ IP

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –°–æ–∑–¥–∞—Ç—å action –¥–ª—è fail2ban, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Telegram
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π exchanger-bot API

**–ü–ª—é—Å—ã:**
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –±–æ—Ç
- –£–¥–æ–±–Ω–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

**–ú–∏–Ω—É—Å—ã:**
- –ù—É–∂–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ action
- –ù–µ—Ç –º–µ—Ç—Ä–∏–∫, —Ç–æ–ª—å–∫–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

### 5. üìà Prometheus + Grafana
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω–µ  
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** Prometheus, Grafana (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –≤ Prometheus

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**
- **fail2ban-prometheus-exporter** - –≥–æ—Ç–æ–≤—ã–π exporter
- **node_exporter textfile collector** - –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
- **Custom exporter** - —Å–≤–æ–π —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä

**–ü–ª—é—Å—ã:**
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –¥–∞—à–±–æ—Ä–¥—ã
- –ò—Å—Ç–æ—Ä–∏—è –º–µ—Ç—Ä–∏–∫
- –ê–ª–µ—Ä—Ç—ã

**–ú–∏–Ω—É—Å—ã:**
- –¢—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Prometheus
- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

---

### 6. üîî Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω–µ  
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** HTTP endpoint –¥–ª—è –ø—Ä–∏–µ–º–∞ webhook  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –Ω–∞ –≤–Ω–µ—à–Ω–∏–π endpoint

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –°–æ–∑–¥–∞—Ç—å action –¥–ª—è fail2ban
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å POST –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –±–∞–Ω–µ/—Ä–∞–∑–±–∞–Ω–µ

**–ü–ª—é—Å—ã:**
- –ì–∏–±–∫–æ—Å—Ç—å
- –ú–æ–∂–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –ª—é–±–æ–π —Å–∏—Å—Ç–µ–º–æ–π
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π API

**–ú–∏–Ω—É—Å—ã:**
- –ù—É–∂–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- –¢—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–π endpoint

---

### 7. üìä –ü—Ä–æ—Å—Ç–æ–π HTTP endpoint –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ü—Ä–æ—Å—Ç–æ  
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** –í–µ–±-—Å–µ—Ä–≤–µ—Ä (nginx/apache)  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ HTTP

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- CGI —Å–∫—Ä–∏–ø—Ç –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ–π Python/Node.js —Å–µ—Ä–≤–µ—Ä
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç JSON —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º

**–ü–ª—é—Å—ã:**
- –ü—Ä–æ—Å—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
- –ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞
- –õ–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏
- –ù—É–∂–µ–Ω –≤–µ–±-—Å–µ—Ä–≤–µ—Ä

---

### 8. üìã Cron —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ  
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** Cron  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–æ–≤

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –°–∫—Ä–∏–ø—Ç —Å–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç—á–µ—Ç –ø–æ email/Telegram

**–ü–ª—é—Å—ã:**
- –û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ—Ç—á–µ—Ç—ã

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ù–µ—Ç –≥—Ä–∞—Ñ–∏–∫–æ–≤

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
1. **Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - —É–∂–µ –µ—Å—Ç—å, –ø—Ä–æ—Å—Ç–æ –≤–∫–ª—é—á–∏—Ç—å
2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ syslog** - —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
3. **Cron —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å

### –î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
1. **Prometheus + Grafana** - –µ—Å–ª–∏ –Ω—É–∂–Ω—ã –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –∏—Å—Ç–æ—Ä–∏—è
2. **Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –µ—Å–ª–∏ –µ—Å—Ç—å –±–æ—Ç
3. **Webhook** - –µ—Å–ª–∏ –µ—Å—Ç—å API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

---

## üí° –ß—Ç–æ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±—ã—Å—Ç—Ä–æ:

1. ‚úÖ **Cron —Å–∫—Ä–∏–ø—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤** (5 –º–∏–Ω—É—Ç)
2. ‚úÖ **Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ action** (15 –º–∏–Ω—É—Ç)
3. ‚úÖ **Prometheus textfile collector** (20 –º–∏–Ω—É—Ç)
4. ‚úÖ **–ü—Ä–æ—Å—Ç–æ–π HTTP endpoint** (30 –º–∏–Ω—É—Ç)

---

**–ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –≤–∞–º –±–æ–ª—å—à–µ –ø–æ–¥—Ö–æ–¥–∏—Ç?**
